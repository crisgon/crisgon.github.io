<!DOCTYPE html>
<html lang="pt-br">
<head>
	<meta charset="UTF-8">	
	<meta name="viewport" content="width=device-width">
	<meta name="theme-color" content="#e74c3c">
	<link rel="icon" href="/images/favicon.ico" />
	
		<title>Consumindo uma API de pokemon com Javascript</title>
			
	<link rel="stylesheet" href="/css/style.css">
</head>

<body >
	<main class="container">
		<nav class="mobile-header">
			<button class="mobile-nav-button" data-js="open-nav">
				<i class="fa fa-bars" aria-Label="Menu"></i>
			</button>
		</nav>
			<header class="header" data-js="nav">
		<button class="close-nav" data-js="close-nav"><i class="fa fa-times" aria-hidden="true"></i></button>
		<img src="/images/profile.jpg" alt="Cristiano Gonçalves" class="profile">
		<a href="/">
			<h1 class="site-name">Cristiano Gonçalves</h1>
		</a>
	
		<nav class="navigation">
			<ul class="navigation-list">
				<li class="navigation-link">
					<a href="/">Home</a>
				</li>
				<li class="navigation-link">
					<a href="/about">Sobre</a>
				</li>
				<li class="navigation-link">
					<a href="/projects">Projetos</a>
				</li>
				<li class="navigation-link">
					<a href="/experiments">Experimentos</a>
				</li>
			</ul>
		</nav> 

		<ul class="social-list">
			<li class="social-icon">
				<a href="https://www.facebook.com/cris.gonn" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a>
			</li>
			<li class="social-icon">
				<a href="https://twitter.com/Gonkristiano" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a>
			</li>
			<li class="social-icon">
				<a href="https://www.linkedin.com/in/cristiano-gonçalves-12a395105/" target="_blank"><i class="fa fa-linkedin" aria-hidden="true"></i></a>
			</li>
			<li class="social-icon">
				<a href="https://github.com/crisgon/" target="_blank"><i class="fa fa-github-alt" aria-hidden="true"></i></a>
			</li>
			<li class="social-icon">
				<a href="https://codepen.io/crisgon/" target="_blank"><i class="fa fa-codepen" aria-hidden="true"></i></a>
			</li>
		</ul>
	</header>
		
		<section class="content">
			<a href="/index.html" class="home-link">
  <i class="fa fa-arrow-left" aria-hidden="true"></i>Voltar
</a>
<article class="post-single">
  <header class="post-header">
    <h1 class="post-header-title">Consumindo uma API de pokemon com Javascript</h1>  
    <div class="infos">
      <time datetime="Thu Mar 01 2018 22:57:31 GMT-0300" class="post-header-date">
        <i class="fa fa-calendar" aria-label="Data de publicação"></i> 01/03/2018  |
        <i class="fa fa-clock-o" aria-label="Tempo de leitura"></i> 17 minutos de leitura
      </time>
        
  <ul class="post-tags-list"><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/Javascript/">Javascript</a></li></ul>

    </div>
  </header>
  <p class="post-content">
    <p>Essa semana eu estava dando uma olhada em algumas vagas no <a href="https://github.com/frontendbr/" target="_blank">Front End Brasil</a> e notei que muitas vagas pediam <strong>experiência com o uso de API’s</strong>. Fui correndo pro fórum do Front End Brasil e perguntei: “Como saber se tenho Experiência com API’s?”<br>Com a contribuição do pessoal eu consegui entender um pouco mais sobre API’s e resolvi compartilhar um pouco do meu aprendizado.<br>Esse artigo foi inspirado em <a href="https://www.taniarascia.com/how-to-connect-to-an-api-with-javascript/" target="_blank" rel="noopener">How to connect to an api with javascript</a> e nele  vou mostrar como consumir e manipular os dados de uma API com informações sobre pokemons.</p>
<p>Caso queira já pode dar uma olhada no que será construído nesse artigo. </p>
<ul>
<li><a href="https://crisgon.github.io/pokeinfo">Demonstração</a> </li>
<li><a href="https://github.com/crisgon/pokeinfo" target="_blank" rel="noopener">Códigos</a></li>
</ul>
<h3 id="O-que-e-uma-API"><a href="#O-que-e-uma-API" class="headerlink" title="O que é uma API?"></a>O que é uma API?</h3><p><strong>Se dermos uma “googlada” vamos dar de cara com a seguinte descrição no wikipedia:</strong></p>
<div class="italic">“Interface de Programação de Aplicações (português europeu) ou Interface de Programação de Aplicação (português brasileiro)), cujo acrônimo API provém do Inglês Application Programming<br>Interface, é um conjunto de rotinas e padrões estabelecidos por um software para a utilização<br>das suas funcionalidades por aplicativos que não pretendem envolver-se em detalhes da implementação do software, mas apenas usar seus serviços.<br>De modo geral, a API é composta por uma série de funções acessíveis somente por programação, e que permitem utilizar características do software menos evidentes ao utilizador tradicional.”<br></div>



<p>De forma mais crua, uma API provê uma interface que permite que um software se comunique com outro software sem que seja necessário ter conhecimento do que acontece por de baixo dos panos.<br>Ou seja, uma API pode permitir que tenhamos acesso a geolocalização sem que precisemos saber que blocos de códigos são executadas para que essa geolocalização seja fornecida, pode permitir que seja possível criar contas utilizando o facebook, google ou twitter, ou pode simplismente nos fornecer informações sobre livros.</p>
<p>Vale ressaltar que as API’s não se limitam apenas a WEB, elas estão presentes em diversos outros cenários, como o dos SO’s, dos embarcados e vários outros. Porém se tratando do cenário WEB as API’s se baseiam em requisições e respostas HTTP (requests e responses), que na maioria das vezes seguem o padrão XML ou JSON.</p>
<p><strong>Para entender sobre API’s de forma mais clara faça a leitura desses artigos:</strong></p>
<ul>
<li><a href="https://canaltech.com.br/software/o-que-e-api/" target="_blank" rel="noopener">O que é API</a> </li>
<li><a href="https://www.robinwieruch.de/what-is-an-api-javascript/" target="_blank" rel="noopener">Nobody introduced me to the API</a>.</li>
<li><a href="https://pt.wikipedia.org/wiki/Interface_de_programação_de_aplicações" target="_blank" rel="noopener">Interface de programação de aplicações</a></li>
</ul>
<h2 id="Hey-Oh-let’s-go"><a href="#Hey-Oh-let’s-go" class="headerlink" title="Hey! Oh!, let’s go!"></a>Hey! Oh!, let’s go!</h2><p class="warning">Antes de iniciar quero deixar claro que essa aplicação foi totalmente desenvolvida por mim, então é capaz de conter pequenos bugs e também pode ser que as técnicas que utilizei não tenham sido as melhores, porém senti a necessidade de compartilhar o conhecimento sobre API’s que consegui até agora.<br></p><br>Vamos construir uma pequena aplicação que recebe o nome ou o número de um pokemon e retorna algumas informações sobre o mesmo.<br><p class="center"><br><img src="https://i.imgur.com/bXGuv94.png" alt="Print da aplicação"><br><em>Aplicação utilizando dados de pokemons</em>.<br></p>

<p>Vamos utilizar os dados da <a href="https://pokeapi.co" target="_blank" rel="noopener">pokeapi</a>, toda informação adicional necessária se encontra na documentação da API.</p>
<h4 id="O-HTML-e-o-CSS"><a href="#O-HTML-e-o-CSS" class="headerlink" title="O HTML e o CSS"></a>O HTML e o CSS</h4><p>O foco desse artigo é o javascript, então não vou explicar sobre o HTML e CSS, mas basicamente temos o seguinte HTML:</p>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line">&lt;main <span class="class"><span class="keyword">class</span></span>=<span class="string">"container"</span>&gt;</span><br><span class="line">    &lt;img src=<span class="string">"https://upload.wikimedia.org/wikipedia/commons/9/98/International_Pok%C3%A9mon_logo.svg"</span> alt=<span class="string">"Pokemon Logo"</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;form action=<span class="string">""</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"search"</span>&gt;</span><br><span class="line">      &lt;input <span class="class"><span class="keyword">type</span></span>=<span class="string">"search"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"search-input"</span> placeholder=<span class="string">"Search about a pokemon using name or pokedex number"</span>&gt;</span><br><span class="line">      &lt;button <span class="class"><span class="keyword">class</span></span>=<span class="string">"search-button"</span>&gt;<span class="type">Search</span>&lt;/button&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line"></span><br><span class="line">    &lt;section <span class="class"><span class="keyword">class</span></span>=<span class="string">"pokemon"</span>&gt;</span><br><span class="line">    &lt;/section&gt;</span><br><span class="line">    &lt;span <span class="class"><span class="keyword">class</span></span>=<span class="string">"error"</span>&gt;<span class="type">Not</span> <span class="type">Found</span>!&lt;/span&gt;</span><br><span class="line">  &lt;/main&gt;</span><br></pre></td></tr></table></figure>
<p>Além do form, temos uma section que irá receber os dados dos pokemons e um span que irá aparecer quando uma busca não for bem sucedida.</p>
<p>Caso queira pode fazer o download do <a href="https://github.com/crisgon/pokeinfo/blob/gh-pages/index.html" target="_blank" rel="noopener">HTML</a> e do <a href="https://github.com/crisgon/pokeinfo/blob/gh-pages/pokemons.css" target="_blank" rel="noopener">CSS</a></p>
<h4 id="O-Javascript"><a href="#O-Javascript" class="headerlink" title="O Javascript"></a>O Javascript</h4><p>A primeira coisa que iremos fazer é definir uma constante(também pode ser uma variável) com o URL da API, que também é chamada de endpoint.</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="comment">// API endpoint</span></span><br><span class="line"><span class="keyword">const</span> baseUrl = <span class="symbol">'https</span>:<span class="comment">//pokeapi.co/api/v2/pokemon/';</span></span><br></pre></td></tr></table></figure>
<p>Agora iremos criar uma pequena função para diminuir a escrita na hora de pegar os elementos HTML.<br><figure class="highlight ada"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title">getElement</span>(element) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="type">document.querySelector(element)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Logo em seguida iremos capturar os elementos HTML e criar 3 variáveis globais que usaremos futuramente.</p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Get Elements</span></span><br><span class="line"><span class="keyword">const</span> searchInput = getElement(<span class="string">'.search-input'</span>),</span><br><span class="line">      searchButton = getElement(<span class="string">'.search-button'</span>),</span><br><span class="line">      container = getElement(<span class="string">'.pokemon'</span>),</span><br><span class="line">      erroMessage = getElement(<span class="string">'.error'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> pokeName, <span class="comment">// Nome ou numero passado na caixa de busca</span></span><br><span class="line">    pokemon, <span class="comment">// Responsavel por guardar os dados recebidos da API</span></span><br><span class="line">    card; <span class="comment">// Responsavel por receber o HTML</span></span><br></pre></td></tr></table></figure>
<p><strong>Você pode dar um console.log() em cada uma das constantes para verificar se a captura foi feita corretamente.</strong></p>
<p>Agora vamos estabelecer nossa primeira conexão com a API. Existem diversas maneiras de fazer isso, uma bem usual é utilizando o XMLHttpRequest(), porém utilizaremos o fetch por sua praticidade.</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">fetch(<span class="string">'https://pokeapi.co/api/v2/pokemon/pikachu'</span>)</span><br><span class="line">  .then(<span class="function"><span class="params">response</span> =&gt;</span> response.json())</span><br><span class="line">  .then(<span class="function"><span class="params">data</span> =&gt;</span> <span class="built_in">console</span>.log(data))</span><br><span class="line">  .catch(<span class="function"><span class="params">err</span> =&gt;</span> <span class="built_in">console</span>.log(err));</span><br></pre></td></tr></table></figure>
<p><strong>Abra o console do seu navegador e veja que agora temos um objeto com informações sobre o pokemon pikachu.</strong></p>
<div class="obs">Uma explicação rápida sobre o fetch: Ele é composto por <a href="https://braziljs.org/blog/promises-no-javascript/" target="_blank" rel="noopener">promisses</a> javascript, e basicamente o primeiro .then() recebe a resposta da requisição e por meio de uma função transformamos essa resposta em um json, logo depois o segundo .then() recebe essa resposta, e a imprime no console. Por fim temos o catch que só é executado caso aconteça algum erro na operação e a imprime uma mensagem de erro console.<br></div>


<p>Agora já sabemos como fazer uma requisição! Se você se atentou, precisamos apenas mudar a URL para conseguir informações sobre outro pokemon. Faça o teste substituindo pikachu por outro nome ou algum número.</p>
<h4 id="Vamos-fazer-algumas-alteracoes-no-nosso-codigo-e-ele-deve-ficar-assim"><a href="#Vamos-fazer-algumas-alteracoes-no-nosso-codigo-e-ele-deve-ficar-assim" class="headerlink" title="Vamos fazer algumas alterações no nosso código e ele deve ficar assim:"></a>Vamos fazer algumas alterações no nosso código e ele deve ficar assim:</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// API endpoint --------------------------------------------</span></span><br><span class="line"><span class="keyword">const</span> baseUrl = <span class="string">'https://pokeapi.co/api/v2/pokemon/'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get Elements --------------------------------------------</span></span><br><span class="line"><span class="keyword">const</span> searchInput = getElement(<span class="string">'.search-input'</span>),</span><br><span class="line">      searchButton = getElement(<span class="string">'.search-button'</span>),</span><br><span class="line">      container = getElement(<span class="string">'.pokemon'</span>),</span><br><span class="line">      erroMessage = getElement(<span class="string">'.error'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> pokeName, <span class="comment">// Nome ou numero passado na caixa de busca</span></span><br><span class="line">    pokemon, <span class="comment">// Responsavel por guardar os dados recebidos da API</span></span><br><span class="line">    card; <span class="comment">// Responsavel por receber o HTML </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Build Functions --------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Função para reduzir a escrita na captura de elementos HTML</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getElement</span>(<span class="params">element</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">document</span>.querySelector(element);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Função responsavel por fazer requisições para a API e inserir as respostas na variavel pokemon</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">requestPokeInfo</span>(<span class="params">url, name</span>) </span>&#123;</span><br><span class="line">  fetch(url + name)</span><br><span class="line">    .then(<span class="function"><span class="params">response</span> =&gt;</span> response.json())</span><br><span class="line">    .then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">      pokemon = data;</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="params">err</span> =&gt;</span> <span class="built_in">console</span>.log(err));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(pokemon); <span class="comment">// Execute o console para verificar os dados no console</span></span><br></pre></td></tr></table></figure>
<p>Já sabemos como receber os dados de um pokemon, porém ainda não temos nada dinâmico… Então vamos pegar o valor da caixa de pesquisa e utiliza-lo para pesquisar por um pokemon. Para isso vamos adicionar um evento de click ao botão e atribuir o valor do input para a variável pokeName, que será passada como argumento para nossa função que faz a requisição para a API.</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">searchButton.<span class="keyword">addEventListener('click', </span>event =&gt; &#123;</span><br><span class="line">  event.preventDefault()<span class="comment">;</span></span><br><span class="line">  pokeName = searchInput.value.toLowerCase()<span class="comment">; </span></span><br><span class="line">  <span class="comment">/* A api só aceita nomes minusculos, então vamos usar a função toLowerCase para garantir que nenhuma letra maiuscula seja passada. */</span></span><br><span class="line">  requestPokeInfo(<span class="keyword">baseUrl, </span>pokeName)</span><br><span class="line">&#125;)<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p><strong>Agora podemos escrever o nome de um pokemon e receber dados sobre ele no console do navegador. Faça o teste!! Eai, funcionou?</strong></p>
<p>Agora vamos trazer os dados que estão no console para o nosso documento HTML, pois ninguém quer ficar abrindo o console pra ficar visualizando informações. 😃</p>
<div class="obs">A nossa resposta é um objeto, então podemos acessar suas propriedades como em qualquer objeto javascript. Para recuperarmos o nome do pokemon podemos executar pokemon.name, para o número usamos o pokemon.id e todas as outras informações seguem a mesma lógica.</div>


<p>Vamos criar uma função que irá montar um HTML. Recomendo que pesquise por <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/template_strings" target="_blank" rel="noopener">template strings</a> caso ache a sintaxe ${} estranha.<br><figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line">function createCard () &#123;</span><br><span class="line">  card = `<span class="javascript"></span></span><br><span class="line"><span class="javascript">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"pokemon-picture"</span>&gt;</span></span><br><span class="line"><span class="javascript">      &lt;img src=<span class="string">"$&#123;pokemon.sprites.front_default&#125;"</span> alt=<span class="string">"Sprite of $&#123;pokemon.name&#125;"</span>&gt;</span></span><br><span class="line"><span class="javascript">    &lt;<span class="regexp">/div&gt;</span></span></span><br><span class="line"><span class="javascript">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"pokemon-info"</span>&gt;</span></span><br><span class="line"><span class="javascript">        &lt;h1 <span class="class"><span class="keyword">class</span></span>=<span class="string">"name"</span>&gt;Name: $&#123;pokemon.name&#125;&lt;<span class="regexp">/h1&gt;</span></span></span><br><span class="line"><span class="javascript">        &lt;h2 <span class="class"><span class="keyword">class</span></span>=<span class="string">"number"</span>&gt;Nº $&#123;pokemon.id&#125;&lt;<span class="regexp">/h2&gt;</span></span></span><br><span class="line"><span class="javascript">        &lt;h3 <span class="class"><span class="keyword">class</span></span>=<span class="string">"type"</span>&gt;Type: $&#123;pokemon.types.map(<span class="function"><span class="params">item</span> =&gt;</span> <span class="string">' '</span> + item.type.name).toString()&#125;&lt;<span class="regexp">/h3&gt;</span></span></span><br><span class="line"><span class="javascript">        &lt;h3 <span class="class"><span class="keyword">class</span></span>=<span class="string">"skill"</span>&gt;Skills: $&#123;pokemon.moves.map(<span class="function"><span class="params">item</span> =&gt;</span> <span class="string">' '</span> + item.move.name).toString()&#125;&lt;<span class="regexp">/h3&gt;</span></span></span><br><span class="line"><span class="javascript">        &lt;h3 <span class="class"><span class="keyword">class</span></span>=<span class="string">"weight"</span>&gt;Weight: $&#123;pokemon.weight  / <span class="number">10</span>&#125;kg&lt;<span class="regexp">/h3&gt;</span></span></span><br><span class="line"><span class="javascript">        &lt;h3 <span class="class"><span class="keyword">class</span></span>=<span class="string">"height"</span>&gt;Height: $&#123;pokemon.height  / <span class="number">10</span>&#125;m&lt;<span class="regexp">/h3&gt;</span></span></span><br><span class="line"><span class="javascript">    &lt;<span class="regexp">/div&gt;</span></span>`;</span><br><span class="line">  <span class="keyword">return</span> card;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<div class="obs">O weight e o height (peso e altura) eles vem multiplicados por 10, descobri isso comparando as informações com as do site oficial do Pokemon. Por isso estou dividindo ambos por 10.<br>Outra coisa importante são as informações type e skills (tipo e habilidades). Ambas podem conter um valor ou vários, sendo retornadas como um array. Então utilizei o map para criar um novo array com espaços e logo em seguida converti tudo em string.<br></div>

<p><br><br>Logo em seguida adicione esse pequeno trecho <code>container.innerHTML = createCard();</code> na<br>função do addEventListener do botão, atualize a página e pesquise por um pokemon. Ocorreu algum erro? Certo, vamos corrigir!</p>
<p>O erro acontece porque a função que cria o HTML foi executada antes da requisição terminar, logo temos a mensagem de que não podemos acessar propriedades de undefined. Para resolver isso precisamos fazer com que nossa função que cria o HTML espere um pouco antes de ser executada, vamos utilizar o setTimeout, porém recomendo que pesquise sobre <a href="https://braziljs.org/blog/tag/javascript-assincrono/" target="_blank" rel="noopener">javascript assíncrono</a>.</p>
<p>Criaremos uma função principal que será responsável por fazer a chamada de todas as outras funções existentes.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Função que faz a chamada das principais funções e inicia o app</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">startApp</span><span class="params">(pokeName)</span> </span>&#123;</span><br><span class="line">  requestPokeInfo(baseUrl, pokeName);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// A função que cria o HTML só será executada 2 segundos depois que a função startApp for executada</span></span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">      container.innerHTML = createCard();</span><br><span class="line">  &#125;, <span class="number">2000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Faça uma mudança na função de click do botão, faça com que a única função a ser executada seja a startApp.</p>
<h4 id="Com-as-alteracoes-feitas-nosso-codigo-deve-ficar-assim"><a href="#Com-as-alteracoes-feitas-nosso-codigo-deve-ficar-assim" class="headerlink" title="Com as alterações feitas nosso código deve ficar assim"></a>Com as alterações feitas nosso código deve ficar assim</h4><figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="comment">// API endpoint --------------------------------------------</span></span><br><span class="line"><span class="keyword">const</span> baseUrl = <span class="string">'https://pokeapi.co/api/v2/pokemon/'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get Elements --------------------------------------------</span></span><br><span class="line"><span class="keyword">const</span> searchInput = getElement(<span class="string">'.search-input'</span>),</span><br><span class="line">      searchButton = getElement(<span class="string">'.search-button'</span>),</span><br><span class="line">      container = getElement(<span class="string">'.pokemon'</span>),</span><br><span class="line">      erroMessage = getElement(<span class="string">'.error'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> pokeName, <span class="comment">// Nome ou numero passado na caixa de busca</span></span><br><span class="line">    pokemon, <span class="comment">// Responsavel por guardar os dados recebidos da API</span></span><br><span class="line">    card; <span class="comment">// Responsavel por receber o HTML </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Build Functions --------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Função para reduzir a escrita na captura de elementos HTML</span></span><br><span class="line"><span class="function">function <span class="title">getElement</span>(<span class="params">element</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> document.querySelector(element);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Função responsavel por fazer requisições para a API e inserir as respostas na variavel pokemon</span></span><br><span class="line"><span class="function">function <span class="title">requestPokeInfo</span>(<span class="params">url, name</span>) </span>&#123;</span><br><span class="line">  fetch(url + name)</span><br><span class="line">    .then(response =&gt; response.json())</span><br><span class="line">    .then(data =&gt; &#123;</span><br><span class="line">      pokemon = data;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="keyword">catch</span>(err =&gt; console.log(err));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Função responsavel por montar o HTML exibido na pagina</span></span><br><span class="line"><span class="function">function <span class="title">createCard</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  card = `</span><br><span class="line">    &lt;div <span class="keyword">class</span>=<span class="string">"pokemon-picture"</span>&gt;</span><br><span class="line">      &lt;img src=<span class="string">"$&#123;pokemon.sprites.front_default&#125;"</span> alt=<span class="string">"Sprite of $&#123;pokemon.name&#125;"</span>&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div <span class="keyword">class</span>=<span class="string">"pokemon-info"</span>&gt;</span><br><span class="line">        &lt;h1 <span class="keyword">class</span>=<span class="string">"name"</span>&gt;Name: $&#123;pokemon.name&#125;&lt;/h1&gt;</span><br><span class="line">        &lt;h2 <span class="keyword">class</span>=<span class="string">"number"</span>&gt;Nº $&#123;pokemon.id&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;h3 <span class="keyword">class</span>=<span class="string">"type"</span>&gt;Type: $&#123;pokemon.types.map(item =&gt; item.type.name).toString()&#125;&lt;/h3&gt;</span><br><span class="line">        &lt;h3 <span class="keyword">class</span>=<span class="string">"skill"</span>&gt;Skills: $&#123;pokemon.moves.map(item =&gt; <span class="string">' '</span> + item.move.name).toString()&#125;&lt;/h3&gt;</span><br><span class="line">        &lt;h3 <span class="keyword">class</span>=<span class="string">"weight"</span>&gt;Weight: $&#123;pokemon.weight  / <span class="number">10</span>&#125;kg&lt;/h3&gt;</span><br><span class="line">        &lt;h3 <span class="keyword">class</span>=<span class="string">"height"</span>&gt;Height: $&#123;pokemon.height  / <span class="number">10</span>&#125;m&lt;/h3&gt;</span><br><span class="line">    &lt;/div&gt;`;</span><br><span class="line">  <span class="keyword">return</span> card;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Função que faz a chamada das principais funções e inicia o app</span></span><br><span class="line"><span class="function">function <span class="title">startApp</span>(<span class="params">pokeName</span>) </span>&#123;</span><br><span class="line">  requestPokeInfo(baseUrl, pokeName);</span><br><span class="line"></span><br><span class="line">  setTimeout(function () &#123;</span><br><span class="line">      container.innerHTML = createCard();</span><br><span class="line">  &#125;, <span class="number">2000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Add Events --------------------------------------------</span></span><br><span class="line">searchButton.addEventListener(<span class="string">'click'</span>, <span class="keyword">event</span> =&gt; &#123;</span><br><span class="line">  <span class="keyword">event</span>.preventDefault();</span><br><span class="line">  pokeName = searchInput.<span class="keyword">value</span>.toLowerCase();</span><br><span class="line">  startApp(pokeName);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="Ja-podemos-dar-o-nosso-APP-como-finalizado-entao-o-que-vem-a-seguir-e-opcional"><a href="#Ja-podemos-dar-o-nosso-APP-como-finalizado-entao-o-que-vem-a-seguir-e-opcional" class="headerlink" title="Já podemos dar o nosso APP como finalizado, então o que vem a seguir é opcional."></a>Já podemos dar o nosso APP como finalizado, então o que vem a seguir é opcional.</h4><p><strong>A primeira grande mudança que iremos fazer é na função principal</strong><br><figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">startApp</span><span class="params">(pokeName)</span> </span>&#123;</span><br><span class="line">  requestPokeInfo(baseUrl, pokeName);</span><br><span class="line"></span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//Exibe uma mensagem caso o pokemon pesquisado não exista</span></span><br><span class="line">    <span class="keyword">if</span>(pokemon.detail) &#123;</span><br><span class="line">      erroMessage.style.display = <span class="string">'block'</span>;</span><br><span class="line">      container.style.display = <span class="string">'none'</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      erroMessage.style.display = <span class="string">'none'</span>;</span><br><span class="line">      container.style.display = <span class="string">'flex'</span>;</span><br><span class="line">      container.innerHTML = createCard();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="number">2000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Quando uma pesquisa é mal sucedida o retorno é a informação detail. Então verificamos se existe o detail no objeto pokemon, caso exista nós mudamos o display da tag que contém a mensagem de erro para block e mudamos o display da section com as informações do pokemon para none.<br>Se a propriedade detail não existir, significa que a busca foi bem sucedida, então escondemos a mensagem de erro, mostramos a section com as informações e chamamos a função que monta o html.</p>
<p><strong>A próxima grande mudança é no evento de click</strong></p>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Add Events --------------------------------------------</span></span><br><span class="line">searchButton.addEventListener(<span class="string">'click'</span>, <span class="keyword">event</span> =&gt; &#123;</span><br><span class="line">  <span class="keyword">event</span>.preventDefault();</span><br><span class="line">  pokeName = searchInput.<span class="keyword">value</span>.toLowerCase();</span><br><span class="line">  startApp(pokeName);</span><br><span class="line">  container.classList.<span class="keyword">add</span>(<span class="string">'fade'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Reseta o efeito fade removendo a classe fade</span></span><br><span class="line">  setTimeout(() =&gt; &#123;</span><br><span class="line">    container.classList.<span class="keyword">remove</span>(<span class="string">'fade'</span>);</span><br><span class="line">  &#125;, <span class="number">3000</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>Aqui estamos adicionando a classe ‘fade’ ao nosso container, essa classe é responsável por fazer um efeito de transição suave.<br>Logo depois utilizamos o setTimeout() para remover a classe fade depois de 3 segundos para que ela possa ser adicionada novamente no próximo evento de click.</p>
<h4 id="No-fim-de-tudo-o-codigo-deve-ficar-assim"><a href="#No-fim-de-tudo-o-codigo-deve-ficar-assim" class="headerlink" title="No fim de tudo o código deve ficar assim"></a>No fim de tudo o código deve ficar assim</h4><figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="comment">// API endpoint --------------------------------------------</span></span><br><span class="line"><span class="keyword">const</span> baseUrl = <span class="string">'https://pokeapi.co/api/v2/pokemon/'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get Elements --------------------------------------------</span></span><br><span class="line"><span class="keyword">const</span> searchInput = getElement(<span class="string">'.search-input'</span>),</span><br><span class="line">      searchButton = getElement(<span class="string">'.search-button'</span>),</span><br><span class="line">      container = getElement(<span class="string">'.pokemon'</span>),</span><br><span class="line">      erroMessage = getElement(<span class="string">'.error'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> pokeName, <span class="comment">// Nome ou numero passado na caixa de busca</span></span><br><span class="line">    pokemon, <span class="comment">// Responsavel por guardar os dados recebidos da API</span></span><br><span class="line">    card; <span class="comment">// Responsavel por receber o HTML </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Build Functions --------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Função para reduzir a escrita na captura de elementos HTML</span></span><br><span class="line"><span class="function">function <span class="title">getElement</span>(<span class="params">element</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> document.querySelector(element);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Função responsavel por fazer requisições para a API e inserir as respostas na variavel pokemon</span></span><br><span class="line"><span class="function">function <span class="title">requestPokeInfo</span>(<span class="params">url, name</span>) </span>&#123;</span><br><span class="line">  fetch(url + name)</span><br><span class="line">    .then(response =&gt; response.json())</span><br><span class="line">    .then(data =&gt; &#123;</span><br><span class="line">      pokemon = data;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="keyword">catch</span>(err =&gt; console.log(err));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Função responsavel por montar o HTML exibido na pagina</span></span><br><span class="line"><span class="function">function <span class="title">createCard</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  card = `</span><br><span class="line">    &lt;div <span class="keyword">class</span>=<span class="string">"pokemon-picture"</span>&gt;</span><br><span class="line">      &lt;img src=<span class="string">"$&#123;pokemon.sprites.front_default&#125;"</span> alt=<span class="string">"Sprite of $&#123;pokemon.name&#125;"</span>&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div <span class="keyword">class</span>=<span class="string">"pokemon-info"</span>&gt;</span><br><span class="line">        &lt;h1 <span class="keyword">class</span>=<span class="string">"name"</span>&gt;Name: $&#123;pokemon.name&#125;&lt;/h1&gt;</span><br><span class="line">        &lt;h2 <span class="keyword">class</span>=<span class="string">"number"</span>&gt;Nº $&#123;pokemon.id&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;h3 <span class="keyword">class</span>=<span class="string">"type"</span>&gt;Type: $&#123;pokemon.types.map(item =&gt; item.type.name).toString()&#125;&lt;/h3&gt;</span><br><span class="line">        &lt;h3 <span class="keyword">class</span>=<span class="string">"skill"</span>&gt;Skills: $&#123;pokemon.moves.map(item =&gt; <span class="string">' '</span> + item.move.name).toString()&#125;&lt;/h3&gt;</span><br><span class="line">        &lt;h3 <span class="keyword">class</span>=<span class="string">"weight"</span>&gt;Weight: $&#123;pokemon.weight  / <span class="number">10</span>&#125;kg&lt;/h3&gt;</span><br><span class="line">        &lt;h3 <span class="keyword">class</span>=<span class="string">"height"</span>&gt;Height: $&#123;pokemon.height  / <span class="number">10</span>&#125;m&lt;/h3&gt;</span><br><span class="line">    &lt;/div&gt;`;</span><br><span class="line">  <span class="keyword">return</span> card;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Função que faz a chamada das principais funções e inicia o app</span></span><br><span class="line"><span class="function">function <span class="title">startApp</span>(<span class="params">pokeName</span>) </span>&#123;</span><br><span class="line">  requestPokeInfo(baseUrl, pokeName);</span><br><span class="line"></span><br><span class="line">  setTimeout(function () &#123;</span><br><span class="line">    <span class="comment">//Exibe uma mensagem caso o pokemon pesquisado não exista</span></span><br><span class="line">    <span class="keyword">if</span>(pokemon.detail) &#123;</span><br><span class="line">      erroMessage.style.display = <span class="string">'block'</span>;</span><br><span class="line">      container.style.display = <span class="string">'none'</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      erroMessage.style.display = <span class="string">'none'</span>;</span><br><span class="line">      container.style.display = <span class="string">'flex'</span>;</span><br><span class="line">      container.innerHTML = createCard();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="number">2000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Add Events --------------------------------------------</span></span><br><span class="line">searchButton.addEventListener(<span class="string">'click'</span>, <span class="keyword">event</span> =&gt; &#123;</span><br><span class="line">  <span class="keyword">event</span>.preventDefault();</span><br><span class="line">  pokeName = searchInput.<span class="keyword">value</span>.toLowerCase();</span><br><span class="line">  startApp(pokeName);</span><br><span class="line">  container.classList.<span class="keyword">add</span>(<span class="string">'fade'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Reseta o efeito fade removendo a classe fade</span></span><br><span class="line">  setTimeout(() =&gt; &#123;</span><br><span class="line">    container.classList.<span class="keyword">remove</span>(<span class="string">'fade'</span>);</span><br><span class="line">  &#125;, <span class="number">3000</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Isso-e-tudo-pessoal"><a href="#Isso-e-tudo-pessoal" class="headerlink" title="Isso é tudo, pessoal!!"></a>Isso é tudo, pessoal!!</h3><p>Esse artigo foi um pouco mais extenso que o normal, mas foi muito enriquecedor para mim, espero que tenha acrescentado algo nos seus estudos. Provavelmente eu devo ter me equivocado em algum momento ou deixado alguma informação confusa, caso tenha visto algo do tipo é só me avisar, isso vai ajudar muito na minha caminhada para ser um Front End Developer!</p>
<p>Todo esse conteúdo foi feito com base nos seguintes links:</p>
<ul>
<li><a href="https://www.taniarascia.com/how-to-connect-to-an-api-with-javascript/" target="_blank" rel="noopener">How to connect to an api with javascript</a></li>
<li><a href="https://canaltech.com.br/software/o-que-e-api/" target="_blank" rel="noopener">O que é API</a> </li>
<li><a href="https://www.robinwieruch.de/what-is-an-api-javascript/" target="_blank" rel="noopener">Nobody introduced me to the API</a>.</li>
<li><a href="https://pt.wikipedia.org/wiki/Interface_de_programação_de_aplicações" target="_blank" rel="noopener">Interface de programação de aplicações</a></li>
<li><a href="https://github.com/frontendbr/forum/issues" target="_blank" rel="noopener">Front End Brasil</a></li>
</ul>
<p>Obrigado por ler até aqui!! Se curtiu esse post compartilha com seus amigos e deixa um comentário caso tenha alguma sugestão do que posso melhorar.</p>

  </p>
  <div class="comments">
    
  <script>
    var disqus_shortname = 'cristiano-goncalves';
    
    var disqus_url = 'https://crisgon.github.io/posts/Consumindo-uma-API-de-pokemon-com-Javascript/';
    
    (function(){
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
      
    <div id="disqus_thread"></div>
  </div>
</article>    





			<footer class="footer">
  <p>&copy; 2018 Cristiano Gonçalves.</p>
  <p>
    Desenvolvido com <a href="https://hexo.io" target="_blank">Hexo</a>. Inspirado no blog do <a href="http://gabsferreira.com/" target="_blank">Gabriel Ferreira</a>.
  </p>
</footer>
		</section>
		
	</main>
	<script src="/js/index.js"></script>
	<script src="/js/nav.js"></script>
	<script src="https://use.fontawesome.com/3a8d059f5c.js"></script>
</body>
</html>

