<!DOCTYPE html>
<html lang="pt-br">
<head>
	<meta charset="UTF-8">	
	<meta name="viewport" content="width=device-width">
	<meta name="theme-color" content="#e74c3c">
	<link rel="icon" href="/images/favicon.ico" />
	
		<title>Consumindo uma API de pokemon com Javascript</title>
			
	<link rel="stylesheet" href="/css/style.css">
</head>

<body >
	<main class="container">
		<nav class="mobile-header">
			<button class="mobile-nav-button" data-js="open-nav">
				<i class="fa fa-bars" aria-Label="Menu"></i>
			</button>
		</nav>
			<header class="header" data-js="nav">
		<button class="close-nav" data-js="close-nav"><i class="fa fa-times" aria-hidden="true"></i></button>
		<img src="/images/profile.jpg" alt="Cristiano Gon√ßalves" class="profile">
		<a href="/">
			<h1 class="site-name">Cristiano Gon√ßalves</h1>
		</a>
	
		<nav class="navigation">
			<ul class="navigation-list">
				<li class="navigation-link">
					<a href="/">Home</a>
				</li>
				<li class="navigation-link">
					<a href="/about">Sobre</a>
				</li>
				<li class="navigation-link">
					<a href="/projects">Projetos</a>
				</li>
				<li class="navigation-link">
					<a href="/experiments">Experimentos</a>
				</li>
			</ul>
		</nav> 

		<ul class="social-list">
			<li class="social-icon">
				<a href="https://www.facebook.com/cris.gonn" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a>
			</li>
			<li class="social-icon">
				<a href="https://twitter.com/Gonkristiano" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a>
			</li>
			<li class="social-icon">
				<a href="https://www.linkedin.com/in/cristiano-gon√ßalves-12a395105/" target="_blank"><i class="fa fa-linkedin" aria-hidden="true"></i></a>
			</li>
			<li class="social-icon">
				<a href="https://github.com/crisgon/" target="_blank"><i class="fa fa-github-alt" aria-hidden="true"></i></a>
			</li>
			<li class="social-icon">
				<a href="https://codepen.io/crisgon/" target="_blank"><i class="fa fa-codepen" aria-hidden="true"></i></a>
			</li>
		</ul>
	</header>
		
		<section class="content">
			<a href="/index.html" class="home-link">
  <i class="fa fa-arrow-left" aria-hidden="true"></i>Voltar
</a>
<article class="post-single">
  <header class="post-header">
    <h1 class="post-header-title">Consumindo uma API de pokemon com Javascript</h1>  
    <div class="infos">
      <time datetime="Thu Mar 01 2018 22:57:31 GMT-0300" class="post-header-date">
        <i class="fa fa-calendar" aria-label="Data de publica√ß√£o"></i> 01/03/2018  |
        <i class="fa fa-clock-o" aria-label="Tempo de leitura"></i> 17 minutos de leitura
      </time>
        
  <ul class="post-tags-list"><li class="post-tags-list-item"><a class="post-tags-list-link" href="/tags/Javascript/">Javascript</a></li></ul>

    </div>
  </header>
  <p class="post-content">
    <p>Essa semana eu estava dando uma olhada em algumas vagas no <a href="https://github.com/frontendbr/" target="_blank">Front End Brasil</a> e notei que muitas vagas pediam <strong>experi√™ncia com o uso de API‚Äôs</strong>. Fui correndo pro f√≥rum do Front End Brasil e perguntei: ‚ÄúComo saber se tenho Experi√™ncia com API‚Äôs?‚Äù<br>Com a contribui√ß√£o do pessoal eu consegui entender um pouco mais sobre API‚Äôs e resolvi compartilhar um pouco do meu aprendizado.<br>Esse artigo foi inspirado em <a href="https://www.taniarascia.com/how-to-connect-to-an-api-with-javascript/" target="_blank" rel="noopener">How to connect to an api with javascript</a> e nele  vou mostrar como consumir e manipular os dados de uma API com informa√ß√µes sobre pokemons.</p>
<p>Caso queira j√° pode dar uma olhada no que ser√° constru√≠do nesse artigo. </p>
<ul>
<li><a href="https://crisgon.github.io/pokeinfo">Demonstra√ß√£o</a> </li>
<li><a href="https://github.com/crisgon/pokeinfo" target="_blank" rel="noopener">C√≥digos</a></li>
</ul>
<h3 id="O-que-e-uma-API"><a href="#O-que-e-uma-API" class="headerlink" title="O que √© uma API?"></a>O que √© uma API?</h3><p><strong>Se dermos uma ‚Äúgooglada‚Äù vamos dar de cara com a seguinte descri√ß√£o no wikipedia:</strong></p>
<div class="italic">‚ÄúInterface de Programa√ß√£o de Aplica√ß√µes (portugu√™s europeu) ou Interface de Programa√ß√£o de Aplica√ß√£o (portugu√™s brasileiro)), cujo acr√¥nimo API prov√©m do Ingl√™s Application Programming<br>Interface, √© um conjunto de rotinas e padr√µes estabelecidos por um software para a utiliza√ß√£o<br>das suas funcionalidades por aplicativos que n√£o pretendem envolver-se em detalhes da implementa√ß√£o do software, mas apenas usar seus servi√ßos.<br>De modo geral, a API √© composta por uma s√©rie de fun√ß√µes acess√≠veis somente por programa√ß√£o, e que permitem utilizar caracter√≠sticas do software menos evidentes ao utilizador tradicional.‚Äù<br></div>



<p>De forma mais crua, uma API prov√™ uma interface que permite que um software se comunique com outro software sem que seja necess√°rio ter conhecimento do que acontece por de baixo dos panos.<br>Ou seja, uma API pode permitir que tenhamos acesso a geolocaliza√ß√£o sem que precisemos saber que blocos de c√≥digos s√£o executadas para que essa geolocaliza√ß√£o seja fornecida, pode permitir que seja poss√≠vel criar contas utilizando o facebook, google ou twitter, ou pode simplismente nos fornecer informa√ß√µes sobre livros.</p>
<p>Vale ressaltar que as API‚Äôs n√£o se limitam apenas a WEB, elas est√£o presentes em diversos outros cen√°rios, como o dos SO‚Äôs, dos embarcados e v√°rios outros. Por√©m se tratando do cen√°rio WEB as API‚Äôs se baseiam em requisi√ß√µes e respostas HTTP (requests e responses), que na maioria das vezes seguem o padr√£o XML ou JSON.</p>
<p><strong>Para entender sobre API‚Äôs de forma mais clara fa√ßa a leitura desses artigos:</strong></p>
<ul>
<li><a href="https://canaltech.com.br/software/o-que-e-api/" target="_blank" rel="noopener">O que √© API</a> </li>
<li><a href="https://www.robinwieruch.de/what-is-an-api-javascript/" target="_blank" rel="noopener">Nobody introduced me to the API</a>.</li>
<li><a href="https://pt.wikipedia.org/wiki/Interface_de_programa√ß√£o_de_aplica√ß√µes" target="_blank" rel="noopener">Interface de programa√ß√£o de aplica√ß√µes</a></li>
</ul>
<h2 id="Hey-Oh-let‚Äôs-go"><a href="#Hey-Oh-let‚Äôs-go" class="headerlink" title="Hey! Oh!, let‚Äôs go!"></a>Hey! Oh!, let‚Äôs go!</h2><p class="warning">Antes de iniciar quero deixar claro que essa aplica√ß√£o foi totalmente desenvolvida por mim, ent√£o √© capaz de conter pequenos bugs e tamb√©m pode ser que as t√©cnicas que utilizei n√£o tenham sido as melhores, por√©m senti a necessidade de compartilhar o conhecimento sobre API‚Äôs que consegui at√© agora.<br></p><br>Vamos construir uma pequena aplica√ß√£o que recebe o nome ou o n√∫mero de um pokemon e retorna algumas informa√ß√µes sobre o mesmo.<br><p class="center"><br><img src="https://i.imgur.com/bXGuv94.png" alt="Print da aplica√ß√£o"><br><em>Aplica√ß√£o utilizando dados de pokemons</em>.<br></p>

<p>Vamos utilizar os dados da <a href="https://pokeapi.co" target="_blank" rel="noopener">pokeapi</a>, toda informa√ß√£o adicional necess√°ria se encontra na documenta√ß√£o da API.</p>
<h4 id="O-HTML-e-o-CSS"><a href="#O-HTML-e-o-CSS" class="headerlink" title="O HTML e o CSS"></a>O HTML e o CSS</h4><p>O foco desse artigo √© o javascript, ent√£o n√£o vou explicar sobre o HTML e CSS, mas basicamente temos o seguinte HTML:</p>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line">&lt;main <span class="class"><span class="keyword">class</span></span>=<span class="string">"container"</span>&gt;</span><br><span class="line">    &lt;img src=<span class="string">"https://upload.wikimedia.org/wikipedia/commons/9/98/International_Pok%C3%A9mon_logo.svg"</span> alt=<span class="string">"Pokemon Logo"</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;form action=<span class="string">""</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"search"</span>&gt;</span><br><span class="line">      &lt;input <span class="class"><span class="keyword">type</span></span>=<span class="string">"search"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"search-input"</span> placeholder=<span class="string">"Search about a pokemon using name or pokedex number"</span>&gt;</span><br><span class="line">      &lt;button <span class="class"><span class="keyword">class</span></span>=<span class="string">"search-button"</span>&gt;<span class="type">Search</span>&lt;/button&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line"></span><br><span class="line">    &lt;section <span class="class"><span class="keyword">class</span></span>=<span class="string">"pokemon"</span>&gt;</span><br><span class="line">    &lt;/section&gt;</span><br><span class="line">    &lt;span <span class="class"><span class="keyword">class</span></span>=<span class="string">"error"</span>&gt;<span class="type">Not</span> <span class="type">Found</span>!&lt;/span&gt;</span><br><span class="line">  &lt;/main&gt;</span><br></pre></td></tr></table></figure>
<p>Al√©m do form, temos uma section que ir√° receber os dados dos pokemons e um span que ir√° aparecer quando uma busca n√£o for bem sucedida.</p>
<p>Caso queira pode fazer o download do <a href="https://github.com/crisgon/pokeinfo/blob/gh-pages/index.html" target="_blank" rel="noopener">HTML</a> e do <a href="https://github.com/crisgon/pokeinfo/blob/gh-pages/pokemons.css" target="_blank" rel="noopener">CSS</a></p>
<h4 id="O-Javascript"><a href="#O-Javascript" class="headerlink" title="O Javascript"></a>O Javascript</h4><p>A primeira coisa que iremos fazer √© definir uma constante(tamb√©m pode ser uma vari√°vel) com o URL da API, que tamb√©m √© chamada de endpoint.</p>
<figure class="highlight rust"><table><tr><td class="code"><pre><span class="line"><span class="comment">// API endpoint</span></span><br><span class="line"><span class="keyword">const</span> baseUrl = <span class="symbol">'https</span>:<span class="comment">//pokeapi.co/api/v2/pokemon/';</span></span><br></pre></td></tr></table></figure>
<p>Agora iremos criar uma pequena fun√ß√£o para diminuir a escrita na hora de pegar os elementos HTML.<br><figure class="highlight ada"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title">getElement</span>(element) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="type">document.querySelector(element)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Logo em seguida iremos capturar os elementos HTML e criar 3 vari√°veis globais que usaremos futuramente.</p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Get Elements</span></span><br><span class="line"><span class="keyword">const</span> searchInput = getElement(<span class="string">'.search-input'</span>),</span><br><span class="line">      searchButton = getElement(<span class="string">'.search-button'</span>),</span><br><span class="line">      container = getElement(<span class="string">'.pokemon'</span>),</span><br><span class="line">      erroMessage = getElement(<span class="string">'.error'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> pokeName, <span class="comment">// Nome ou numero passado na caixa de busca</span></span><br><span class="line">    pokemon, <span class="comment">// Responsavel por guardar os dados recebidos da API</span></span><br><span class="line">    card; <span class="comment">// Responsavel por receber o HTML</span></span><br></pre></td></tr></table></figure>
<p><strong>Voc√™ pode dar um console.log() em cada uma das constantes para verificar se a captura foi feita corretamente.</strong></p>
<p>Agora vamos estabelecer nossa primeira conex√£o com a API. Existem diversas maneiras de fazer isso, uma bem usual √© utilizando o XMLHttpRequest(), por√©m utilizaremos o fetch por sua praticidade.</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">fetch(<span class="string">'https://pokeapi.co/api/v2/pokemon/pikachu'</span>)</span><br><span class="line">  .then(<span class="function"><span class="params">response</span> =&gt;</span> response.json())</span><br><span class="line">  .then(<span class="function"><span class="params">data</span> =&gt;</span> <span class="built_in">console</span>.log(data))</span><br><span class="line">  .catch(<span class="function"><span class="params">err</span> =&gt;</span> <span class="built_in">console</span>.log(err));</span><br></pre></td></tr></table></figure>
<p><strong>Abra o console do seu navegador e veja que agora temos um objeto com informa√ß√µes sobre o pokemon pikachu.</strong></p>
<div class="obs">Uma explica√ß√£o r√°pida sobre o fetch: Ele √© composto por <a href="https://braziljs.org/blog/promises-no-javascript/" target="_blank" rel="noopener">promisses</a> javascript, e basicamente o primeiro .then() recebe a resposta da requisi√ß√£o e por meio de uma fun√ß√£o transformamos essa resposta em um json, logo depois o segundo .then() recebe essa resposta, e a imprime no console. Por fim temos o catch que s√≥ √© executado caso aconte√ßa algum erro na opera√ß√£o e a imprime uma mensagem de erro console.<br></div>


<p>Agora j√° sabemos como fazer uma requisi√ß√£o! Se voc√™ se atentou, precisamos apenas mudar a URL para conseguir informa√ß√µes sobre outro pokemon. Fa√ßa o teste substituindo pikachu por outro nome ou algum n√∫mero.</p>
<h4 id="Vamos-fazer-algumas-alteracoes-no-nosso-codigo-e-ele-deve-ficar-assim"><a href="#Vamos-fazer-algumas-alteracoes-no-nosso-codigo-e-ele-deve-ficar-assim" class="headerlink" title="Vamos fazer algumas altera√ß√µes no nosso c√≥digo e ele deve ficar assim:"></a>Vamos fazer algumas altera√ß√µes no nosso c√≥digo e ele deve ficar assim:</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// API endpoint --------------------------------------------</span></span><br><span class="line"><span class="keyword">const</span> baseUrl = <span class="string">'https://pokeapi.co/api/v2/pokemon/'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get Elements --------------------------------------------</span></span><br><span class="line"><span class="keyword">const</span> searchInput = getElement(<span class="string">'.search-input'</span>),</span><br><span class="line">      searchButton = getElement(<span class="string">'.search-button'</span>),</span><br><span class="line">      container = getElement(<span class="string">'.pokemon'</span>),</span><br><span class="line">      erroMessage = getElement(<span class="string">'.error'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> pokeName, <span class="comment">// Nome ou numero passado na caixa de busca</span></span><br><span class="line">    pokemon, <span class="comment">// Responsavel por guardar os dados recebidos da API</span></span><br><span class="line">    card; <span class="comment">// Responsavel por receber o HTML </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Build Functions --------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Fun√ß√£o para reduzir a escrita na captura de elementos HTML</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getElement</span>(<span class="params">element</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">document</span>.querySelector(element);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Fun√ß√£o responsavel por fazer requisi√ß√µes para a API e inserir as respostas na variavel pokemon</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">requestPokeInfo</span>(<span class="params">url, name</span>) </span>&#123;</span><br><span class="line">  fetch(url + name)</span><br><span class="line">    .then(<span class="function"><span class="params">response</span> =&gt;</span> response.json())</span><br><span class="line">    .then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">      pokemon = data;</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="params">err</span> =&gt;</span> <span class="built_in">console</span>.log(err));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(pokemon); <span class="comment">// Execute o console para verificar os dados no console</span></span><br></pre></td></tr></table></figure>
<p>J√° sabemos como receber os dados de um pokemon, por√©m ainda n√£o temos nada din√¢mico‚Ä¶ Ent√£o vamos pegar o valor da caixa de pesquisa e utiliza-lo para pesquisar por um pokemon. Para isso vamos adicionar um evento de click ao bot√£o e atribuir o valor do input para a vari√°vel pokeName, que ser√° passada como argumento para nossa fun√ß√£o que faz a requisi√ß√£o para a API.</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">searchButton.<span class="keyword">addEventListener('click', </span>event =&gt; &#123;</span><br><span class="line">  event.preventDefault()<span class="comment">;</span></span><br><span class="line">  pokeName = searchInput.value.toLowerCase()<span class="comment">; </span></span><br><span class="line">  <span class="comment">/* A api s√≥ aceita nomes minusculos, ent√£o vamos usar a fun√ß√£o toLowerCase para garantir que nenhuma letra maiuscula seja passada. */</span></span><br><span class="line">  requestPokeInfo(<span class="keyword">baseUrl, </span>pokeName)</span><br><span class="line">&#125;)<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p><strong>Agora podemos escrever o nome de um pokemon e receber dados sobre ele no console do navegador. Fa√ßa o teste!! Eai, funcionou?</strong></p>
<p>Agora vamos trazer os dados que est√£o no console para o nosso documento HTML, pois ningu√©m quer ficar abrindo o console pra ficar visualizando informa√ß√µes. üòÉ</p>
<div class="obs">A nossa resposta √© um objeto, ent√£o podemos acessar suas propriedades como em qualquer objeto javascript. Para recuperarmos o nome do pokemon podemos executar pokemon.name, para o n√∫mero usamos o pokemon.id e todas as outras informa√ß√µes seguem a mesma l√≥gica.</div>


<p>Vamos criar uma fun√ß√£o que ir√° montar um HTML. Recomendo que pesquise por <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/template_strings" target="_blank" rel="noopener">template strings</a> caso ache a sintaxe ${} estranha.<br><figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line">function createCard () &#123;</span><br><span class="line">  card = `<span class="javascript"></span></span><br><span class="line"><span class="javascript">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"pokemon-picture"</span>&gt;</span></span><br><span class="line"><span class="javascript">      &lt;img src=<span class="string">"$&#123;pokemon.sprites.front_default&#125;"</span> alt=<span class="string">"Sprite of $&#123;pokemon.name&#125;"</span>&gt;</span></span><br><span class="line"><span class="javascript">    &lt;<span class="regexp">/div&gt;</span></span></span><br><span class="line"><span class="javascript">    &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"pokemon-info"</span>&gt;</span></span><br><span class="line"><span class="javascript">        &lt;h1 <span class="class"><span class="keyword">class</span></span>=<span class="string">"name"</span>&gt;Name: $&#123;pokemon.name&#125;&lt;<span class="regexp">/h1&gt;</span></span></span><br><span class="line"><span class="javascript">        &lt;h2 <span class="class"><span class="keyword">class</span></span>=<span class="string">"number"</span>&gt;N¬∫ $&#123;pokemon.id&#125;&lt;<span class="regexp">/h2&gt;</span></span></span><br><span class="line"><span class="javascript">        &lt;h3 <span class="class"><span class="keyword">class</span></span>=<span class="string">"type"</span>&gt;Type: $&#123;pokemon.types.map(<span class="function"><span class="params">item</span> =&gt;</span> <span class="string">' '</span> + item.type.name).toString()&#125;&lt;<span class="regexp">/h3&gt;</span></span></span><br><span class="line"><span class="javascript">        &lt;h3 <span class="class"><span class="keyword">class</span></span>=<span class="string">"skill"</span>&gt;Skills: $&#123;pokemon.moves.map(<span class="function"><span class="params">item</span> =&gt;</span> <span class="string">' '</span> + item.move.name).toString()&#125;&lt;<span class="regexp">/h3&gt;</span></span></span><br><span class="line"><span class="javascript">        &lt;h3 <span class="class"><span class="keyword">class</span></span>=<span class="string">"weight"</span>&gt;Weight: $&#123;pokemon.weight  / <span class="number">10</span>&#125;kg&lt;<span class="regexp">/h3&gt;</span></span></span><br><span class="line"><span class="javascript">        &lt;h3 <span class="class"><span class="keyword">class</span></span>=<span class="string">"height"</span>&gt;Height: $&#123;pokemon.height  / <span class="number">10</span>&#125;m&lt;<span class="regexp">/h3&gt;</span></span></span><br><span class="line"><span class="javascript">    &lt;<span class="regexp">/div&gt;</span></span>`;</span><br><span class="line">  <span class="keyword">return</span> card;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<div class="obs">O weight e o height (peso e altura) eles vem multiplicados por 10, descobri isso comparando as informa√ß√µes com as do site oficial do Pokemon. Por isso estou dividindo ambos por 10.<br>Outra coisa importante s√£o as informa√ß√µes type e skills (tipo e habilidades). Ambas podem conter um valor ou v√°rios, sendo retornadas como um array. Ent√£o utilizei o map para criar um novo array com espa√ßos e logo em seguida converti tudo em string.<br></div>

<p><br><br>Logo em seguida adicione esse pequeno trecho <code>container.innerHTML = createCard();</code> na<br>fun√ß√£o do addEventListener do bot√£o, atualize a p√°gina e pesquise por um pokemon. Ocorreu algum erro? Certo, vamos corrigir!</p>
<p>O erro acontece porque a fun√ß√£o que cria o HTML foi executada antes da requisi√ß√£o terminar, logo temos a mensagem de que n√£o podemos acessar propriedades de undefined. Para resolver isso precisamos fazer com que nossa fun√ß√£o que cria o HTML espere um pouco antes de ser executada, vamos utilizar o setTimeout, por√©m recomendo que pesquise sobre <a href="https://braziljs.org/blog/tag/javascript-assincrono/" target="_blank" rel="noopener">javascript ass√≠ncrono</a>.</p>
<p>Criaremos uma fun√ß√£o principal que ser√° respons√°vel por fazer a chamada de todas as outras fun√ß√µes existentes.</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Fun√ß√£o que faz a chamada das principais fun√ß√µes e inicia o app</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">startApp</span><span class="params">(pokeName)</span> </span>&#123;</span><br><span class="line">  requestPokeInfo(baseUrl, pokeName);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// A fun√ß√£o que cria o HTML s√≥ ser√° executada 2 segundos depois que a fun√ß√£o startApp for executada</span></span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">      container.innerHTML = createCard();</span><br><span class="line">  &#125;, <span class="number">2000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Fa√ßa uma mudan√ßa na fun√ß√£o de click do bot√£o, fa√ßa com que a √∫nica fun√ß√£o a ser executada seja a startApp.</p>
<h4 id="Com-as-alteracoes-feitas-nosso-codigo-deve-ficar-assim"><a href="#Com-as-alteracoes-feitas-nosso-codigo-deve-ficar-assim" class="headerlink" title="Com as altera√ß√µes feitas nosso c√≥digo deve ficar assim"></a>Com as altera√ß√µes feitas nosso c√≥digo deve ficar assim</h4><figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="comment">// API endpoint --------------------------------------------</span></span><br><span class="line"><span class="keyword">const</span> baseUrl = <span class="string">'https://pokeapi.co/api/v2/pokemon/'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get Elements --------------------------------------------</span></span><br><span class="line"><span class="keyword">const</span> searchInput = getElement(<span class="string">'.search-input'</span>),</span><br><span class="line">      searchButton = getElement(<span class="string">'.search-button'</span>),</span><br><span class="line">      container = getElement(<span class="string">'.pokemon'</span>),</span><br><span class="line">      erroMessage = getElement(<span class="string">'.error'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> pokeName, <span class="comment">// Nome ou numero passado na caixa de busca</span></span><br><span class="line">    pokemon, <span class="comment">// Responsavel por guardar os dados recebidos da API</span></span><br><span class="line">    card; <span class="comment">// Responsavel por receber o HTML </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Build Functions --------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Fun√ß√£o para reduzir a escrita na captura de elementos HTML</span></span><br><span class="line"><span class="function">function <span class="title">getElement</span>(<span class="params">element</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> document.querySelector(element);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Fun√ß√£o responsavel por fazer requisi√ß√µes para a API e inserir as respostas na variavel pokemon</span></span><br><span class="line"><span class="function">function <span class="title">requestPokeInfo</span>(<span class="params">url, name</span>) </span>&#123;</span><br><span class="line">  fetch(url + name)</span><br><span class="line">    .then(response =&gt; response.json())</span><br><span class="line">    .then(data =&gt; &#123;</span><br><span class="line">      pokemon = data;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="keyword">catch</span>(err =&gt; console.log(err));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Fun√ß√£o responsavel por montar o HTML exibido na pagina</span></span><br><span class="line"><span class="function">function <span class="title">createCard</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  card = `</span><br><span class="line">    &lt;div <span class="keyword">class</span>=<span class="string">"pokemon-picture"</span>&gt;</span><br><span class="line">      &lt;img src=<span class="string">"$&#123;pokemon.sprites.front_default&#125;"</span> alt=<span class="string">"Sprite of $&#123;pokemon.name&#125;"</span>&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div <span class="keyword">class</span>=<span class="string">"pokemon-info"</span>&gt;</span><br><span class="line">        &lt;h1 <span class="keyword">class</span>=<span class="string">"name"</span>&gt;Name: $&#123;pokemon.name&#125;&lt;/h1&gt;</span><br><span class="line">        &lt;h2 <span class="keyword">class</span>=<span class="string">"number"</span>&gt;N¬∫ $&#123;pokemon.id&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;h3 <span class="keyword">class</span>=<span class="string">"type"</span>&gt;Type: $&#123;pokemon.types.map(item =&gt; item.type.name).toString()&#125;&lt;/h3&gt;</span><br><span class="line">        &lt;h3 <span class="keyword">class</span>=<span class="string">"skill"</span>&gt;Skills: $&#123;pokemon.moves.map(item =&gt; <span class="string">' '</span> + item.move.name).toString()&#125;&lt;/h3&gt;</span><br><span class="line">        &lt;h3 <span class="keyword">class</span>=<span class="string">"weight"</span>&gt;Weight: $&#123;pokemon.weight  / <span class="number">10</span>&#125;kg&lt;/h3&gt;</span><br><span class="line">        &lt;h3 <span class="keyword">class</span>=<span class="string">"height"</span>&gt;Height: $&#123;pokemon.height  / <span class="number">10</span>&#125;m&lt;/h3&gt;</span><br><span class="line">    &lt;/div&gt;`;</span><br><span class="line">  <span class="keyword">return</span> card;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Fun√ß√£o que faz a chamada das principais fun√ß√µes e inicia o app</span></span><br><span class="line"><span class="function">function <span class="title">startApp</span>(<span class="params">pokeName</span>) </span>&#123;</span><br><span class="line">  requestPokeInfo(baseUrl, pokeName);</span><br><span class="line"></span><br><span class="line">  setTimeout(function () &#123;</span><br><span class="line">      container.innerHTML = createCard();</span><br><span class="line">  &#125;, <span class="number">2000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Add Events --------------------------------------------</span></span><br><span class="line">searchButton.addEventListener(<span class="string">'click'</span>, <span class="keyword">event</span> =&gt; &#123;</span><br><span class="line">  <span class="keyword">event</span>.preventDefault();</span><br><span class="line">  pokeName = searchInput.<span class="keyword">value</span>.toLowerCase();</span><br><span class="line">  startApp(pokeName);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="Ja-podemos-dar-o-nosso-APP-como-finalizado-entao-o-que-vem-a-seguir-e-opcional"><a href="#Ja-podemos-dar-o-nosso-APP-como-finalizado-entao-o-que-vem-a-seguir-e-opcional" class="headerlink" title="J√° podemos dar o nosso APP como finalizado, ent√£o o que vem a seguir √© opcional."></a>J√° podemos dar o nosso APP como finalizado, ent√£o o que vem a seguir √© opcional.</h4><p><strong>A primeira grande mudan√ßa que iremos fazer √© na fun√ß√£o principal</strong><br><figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">startApp</span><span class="params">(pokeName)</span> </span>&#123;</span><br><span class="line">  requestPokeInfo(baseUrl, pokeName);</span><br><span class="line"></span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//Exibe uma mensagem caso o pokemon pesquisado n√£o exista</span></span><br><span class="line">    <span class="keyword">if</span>(pokemon.detail) &#123;</span><br><span class="line">      erroMessage.style.display = <span class="string">'block'</span>;</span><br><span class="line">      container.style.display = <span class="string">'none'</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      erroMessage.style.display = <span class="string">'none'</span>;</span><br><span class="line">      container.style.display = <span class="string">'flex'</span>;</span><br><span class="line">      container.innerHTML = createCard();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="number">2000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Quando uma pesquisa √© mal sucedida o retorno √© a informa√ß√£o detail. Ent√£o verificamos se existe o detail no objeto pokemon, caso exista n√≥s mudamos o display da tag que cont√©m a mensagem de erro para block e mudamos o display da section com as informa√ß√µes do pokemon para none.<br>Se a propriedade detail n√£o existir, significa que a busca foi bem sucedida, ent√£o escondemos a mensagem de erro, mostramos a section com as informa√ß√µes e chamamos a fun√ß√£o que monta o html.</p>
<p><strong>A pr√≥xima grande mudan√ßa √© no evento de click</strong></p>
<figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Add Events --------------------------------------------</span></span><br><span class="line">searchButton.addEventListener(<span class="string">'click'</span>, <span class="keyword">event</span> =&gt; &#123;</span><br><span class="line">  <span class="keyword">event</span>.preventDefault();</span><br><span class="line">  pokeName = searchInput.<span class="keyword">value</span>.toLowerCase();</span><br><span class="line">  startApp(pokeName);</span><br><span class="line">  container.classList.<span class="keyword">add</span>(<span class="string">'fade'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Reseta o efeito fade removendo a classe fade</span></span><br><span class="line">  setTimeout(() =&gt; &#123;</span><br><span class="line">    container.classList.<span class="keyword">remove</span>(<span class="string">'fade'</span>);</span><br><span class="line">  &#125;, <span class="number">3000</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>Aqui estamos adicionando a classe ‚Äòfade‚Äô ao nosso container, essa classe √© respons√°vel por fazer um efeito de transi√ß√£o suave.<br>Logo depois utilizamos o setTimeout() para remover a classe fade depois de 3 segundos para que ela possa ser adicionada novamente no pr√≥ximo evento de click.</p>
<h4 id="No-fim-de-tudo-o-codigo-deve-ficar-assim"><a href="#No-fim-de-tudo-o-codigo-deve-ficar-assim" class="headerlink" title="No fim de tudo o c√≥digo deve ficar assim"></a>No fim de tudo o c√≥digo deve ficar assim</h4><figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="comment">// API endpoint --------------------------------------------</span></span><br><span class="line"><span class="keyword">const</span> baseUrl = <span class="string">'https://pokeapi.co/api/v2/pokemon/'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get Elements --------------------------------------------</span></span><br><span class="line"><span class="keyword">const</span> searchInput = getElement(<span class="string">'.search-input'</span>),</span><br><span class="line">      searchButton = getElement(<span class="string">'.search-button'</span>),</span><br><span class="line">      container = getElement(<span class="string">'.pokemon'</span>),</span><br><span class="line">      erroMessage = getElement(<span class="string">'.error'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> pokeName, <span class="comment">// Nome ou numero passado na caixa de busca</span></span><br><span class="line">    pokemon, <span class="comment">// Responsavel por guardar os dados recebidos da API</span></span><br><span class="line">    card; <span class="comment">// Responsavel por receber o HTML </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Build Functions --------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Fun√ß√£o para reduzir a escrita na captura de elementos HTML</span></span><br><span class="line"><span class="function">function <span class="title">getElement</span>(<span class="params">element</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> document.querySelector(element);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Fun√ß√£o responsavel por fazer requisi√ß√µes para a API e inserir as respostas na variavel pokemon</span></span><br><span class="line"><span class="function">function <span class="title">requestPokeInfo</span>(<span class="params">url, name</span>) </span>&#123;</span><br><span class="line">  fetch(url + name)</span><br><span class="line">    .then(response =&gt; response.json())</span><br><span class="line">    .then(data =&gt; &#123;</span><br><span class="line">      pokemon = data;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="keyword">catch</span>(err =&gt; console.log(err));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Fun√ß√£o responsavel por montar o HTML exibido na pagina</span></span><br><span class="line"><span class="function">function <span class="title">createCard</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  card = `</span><br><span class="line">    &lt;div <span class="keyword">class</span>=<span class="string">"pokemon-picture"</span>&gt;</span><br><span class="line">      &lt;img src=<span class="string">"$&#123;pokemon.sprites.front_default&#125;"</span> alt=<span class="string">"Sprite of $&#123;pokemon.name&#125;"</span>&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div <span class="keyword">class</span>=<span class="string">"pokemon-info"</span>&gt;</span><br><span class="line">        &lt;h1 <span class="keyword">class</span>=<span class="string">"name"</span>&gt;Name: $&#123;pokemon.name&#125;&lt;/h1&gt;</span><br><span class="line">        &lt;h2 <span class="keyword">class</span>=<span class="string">"number"</span>&gt;N¬∫ $&#123;pokemon.id&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;h3 <span class="keyword">class</span>=<span class="string">"type"</span>&gt;Type: $&#123;pokemon.types.map(item =&gt; item.type.name).toString()&#125;&lt;/h3&gt;</span><br><span class="line">        &lt;h3 <span class="keyword">class</span>=<span class="string">"skill"</span>&gt;Skills: $&#123;pokemon.moves.map(item =&gt; <span class="string">' '</span> + item.move.name).toString()&#125;&lt;/h3&gt;</span><br><span class="line">        &lt;h3 <span class="keyword">class</span>=<span class="string">"weight"</span>&gt;Weight: $&#123;pokemon.weight  / <span class="number">10</span>&#125;kg&lt;/h3&gt;</span><br><span class="line">        &lt;h3 <span class="keyword">class</span>=<span class="string">"height"</span>&gt;Height: $&#123;pokemon.height  / <span class="number">10</span>&#125;m&lt;/h3&gt;</span><br><span class="line">    &lt;/div&gt;`;</span><br><span class="line">  <span class="keyword">return</span> card;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Fun√ß√£o que faz a chamada das principais fun√ß√µes e inicia o app</span></span><br><span class="line"><span class="function">function <span class="title">startApp</span>(<span class="params">pokeName</span>) </span>&#123;</span><br><span class="line">  requestPokeInfo(baseUrl, pokeName);</span><br><span class="line"></span><br><span class="line">  setTimeout(function () &#123;</span><br><span class="line">    <span class="comment">//Exibe uma mensagem caso o pokemon pesquisado n√£o exista</span></span><br><span class="line">    <span class="keyword">if</span>(pokemon.detail) &#123;</span><br><span class="line">      erroMessage.style.display = <span class="string">'block'</span>;</span><br><span class="line">      container.style.display = <span class="string">'none'</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      erroMessage.style.display = <span class="string">'none'</span>;</span><br><span class="line">      container.style.display = <span class="string">'flex'</span>;</span><br><span class="line">      container.innerHTML = createCard();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="number">2000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Add Events --------------------------------------------</span></span><br><span class="line">searchButton.addEventListener(<span class="string">'click'</span>, <span class="keyword">event</span> =&gt; &#123;</span><br><span class="line">  <span class="keyword">event</span>.preventDefault();</span><br><span class="line">  pokeName = searchInput.<span class="keyword">value</span>.toLowerCase();</span><br><span class="line">  startApp(pokeName);</span><br><span class="line">  container.classList.<span class="keyword">add</span>(<span class="string">'fade'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Reseta o efeito fade removendo a classe fade</span></span><br><span class="line">  setTimeout(() =&gt; &#123;</span><br><span class="line">    container.classList.<span class="keyword">remove</span>(<span class="string">'fade'</span>);</span><br><span class="line">  &#125;, <span class="number">3000</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="Isso-e-tudo-pessoal"><a href="#Isso-e-tudo-pessoal" class="headerlink" title="Isso √© tudo, pessoal!!"></a>Isso √© tudo, pessoal!!</h3><p>Esse artigo foi um pouco mais extenso que o normal, mas foi muito enriquecedor para mim, espero que tenha acrescentado algo nos seus estudos. Provavelmente eu devo ter me equivocado em algum momento ou deixado alguma informa√ß√£o confusa, caso tenha visto algo do tipo √© s√≥ me avisar, isso vai ajudar muito na minha caminhada para ser um Front End Developer!</p>
<p>Todo esse conte√∫do foi feito com base nos seguintes links:</p>
<ul>
<li><a href="https://www.taniarascia.com/how-to-connect-to-an-api-with-javascript/" target="_blank" rel="noopener">How to connect to an api with javascript</a></li>
<li><a href="https://canaltech.com.br/software/o-que-e-api/" target="_blank" rel="noopener">O que √© API</a> </li>
<li><a href="https://www.robinwieruch.de/what-is-an-api-javascript/" target="_blank" rel="noopener">Nobody introduced me to the API</a>.</li>
<li><a href="https://pt.wikipedia.org/wiki/Interface_de_programa√ß√£o_de_aplica√ß√µes" target="_blank" rel="noopener">Interface de programa√ß√£o de aplica√ß√µes</a></li>
<li><a href="https://github.com/frontendbr/forum/issues" target="_blank" rel="noopener">Front End Brasil</a></li>
</ul>
<p>Obrigado por ler at√© aqui!! Se curtiu esse post compartilha com seus amigos e deixa um coment√°rio caso tenha alguma sugest√£o do que posso melhorar.</p>

  </p>
  <div class="comments">
    
  <script>
    var disqus_shortname = 'cristiano-goncalves';
    
    var disqus_url = 'https://crisgon.github.io/posts/Consumindo-uma-API-de-pokemon-com-Javascript/';
    
    (function(){
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
      
    <div id="disqus_thread"></div>
  </div>
</article>    





			<footer class="footer">
  <p>&copy; 2018 Cristiano Gon√ßalves.</p>
  <p>
    Desenvolvido com <a href="https://hexo.io" target="_blank">Hexo</a>. Inspirado no blog do <a href="http://gabsferreira.com/" target="_blank">Gabriel Ferreira</a>.
  </p>
</footer>
		</section>
		
	</main>
	<script src="/js/index.js"></script>
	<script src="/js/nav.js"></script>
	<script src="https://use.fontawesome.com/3a8d059f5c.js"></script>
</body>
</html>

